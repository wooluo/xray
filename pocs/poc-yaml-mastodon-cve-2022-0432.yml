name: poc-yaml-mastodon-cve-2022-0432
manual: true
transport: http
rules:
    r1:
        request:
            method: GET
            path: "/embed.js"
        expression: response.status == 200 && response.body.bcontains(b"if (data.type !== 'setHeight' || !iframes[data.id]) {")
expression: r1()
detail:
    author: Jarcis-cy(https://github.com/jarcis-cy)
    links:
        - https://huntr.dev/bounties/d06da292-7716-4d74-a129-dd04773398d7/
        - https://github.com/mastodon/mastodon/commit/4d6d4b43c6186a13e67b92eaf70fe1b70ea24a09